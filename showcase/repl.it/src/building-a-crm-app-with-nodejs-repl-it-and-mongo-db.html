<!DOCTYPE html>
<html lang="en">
<head>
<link rel='canonical' href='https://www.codementor.io/@garethdwyer/building-a-crm-app-with-nodejs-repl-it-and-mongodb-119r72mczg'>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<title>Building a CRM app with NodeJS, Repl.it, and MongoDB</title>
<style>
@import url(//cdnjs.cloudflare.com/ajax/libs/font-awesome/3.2.0/css/font-awesome.css);
/* normalize.css v2.1.1 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address styling not present in IE 8/9. */
[hidden] { display: none; }

/* ========================================================================== Base ========================================================================== */
/** 1. Prevent system color scheme's background color being used in Firefox, IE, and Opera. 2. Prevent system color scheme's text color being used in Firefox, IE, and Opera. 3. Set default font family to sans-serif. 4. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { background: #fff; /* 1 */ color: #000; /* 2 */ font-family: sans-serif; /* 3 */ -ms-text-size-adjust: 100%; /* 4 */ -webkit-text-size-adjust: 100%; /* 4 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 100%; }

body { background: white; color: #222222; padding: 0; margin: 0; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }

a:hover { cursor: pointer; }

a:focus { outline: none; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; }

.hide { display: none; }

.antialiased, body { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }

.subheader, #content #toctitle, .admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title, .videoblock > .title, .listingblock > .title, .literalblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title, .tableblock > caption { line-height: 1.4; color: #111111; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #ad141e; text-decoration: underline; line-height: inherit; }
a:hover, a:focus { color: #ad141e; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: inherit; font-weight: normal; font-size: 1em; line-height: 1.5; margin-bottom: 1.25em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: "Helvetica Neue", "Helvetica", Arial, sans-serif; font-weight: normal; font-style: normal; color: #111111; text-rendering: optimizeLegibility; margin-top: 1em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #5e5e5e; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #dddddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: "Andale Mono", "monotype.com", "Lucida Console", monospace; font-weight: normal; color: #222222; }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.5; margin-bottom: 1.25em; list-style-position: outside; font-family: inherit; }

ul, ol { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3125em; font-weight: bold; }
dl dd { margin-bottom: 1.25em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: #222222; border-bottom: 1px dotted #dddddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: inherit; color: #555555; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #555555; }

blockquote, blockquote p { line-height: 1.5; color: #6f6f6f; }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
/* Print styles.  Inlined to avoid required HTTP connection: www.phpied.com/delay-loading-your-print-css/ Credit to Paul Irish and HTML5 Boilerplate (html5boilerplate.com)
*/
.print-only { display: none !important; }

@media print { * { background: transparent !important; color: #000 !important; /* Black prints faster: h5bp.com/s */ box-shadow: none !important; text-shadow: none !important; }
  a, a:visited { text-decoration: underline; }
  a[href]:after { content: " (" attr(href) ")"; }
  abbr[title]:after { content: " (" attr(title) ")"; }
  .ir a:after, a[href^="javascript:"]:after, a[href^="#"]:after { content: ""; }
  pre, blockquote { border: 1px solid #999; page-break-inside: avoid; }
  thead { display: table-header-group; /* h5bp.com/t */ }
  tr, img { page-break-inside: avoid; }
  img { max-width: 100% !important; }
  @page { margin: 0.5cm; }
  p, h2, h3, #toctitle, .sidebarblock > .content > .title { orphans: 3; widows: 3; }
  h2, h3, #toctitle, .sidebarblock > .content > .title { page-break-after: avoid; }
  .hide-on-print { display: none !important; }
  .print-only { display: block !important; }
  .hide-for-print { display: none !important; }
  .show-for-print { display: inherit !important; } }
/* Tables */
table { background: white; margin-bottom: 1.25em; border: solid 1px #dddddd; }
table thead, table tfoot { background: whitesmoke; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: #222222; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #222222; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #f9f9f9; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.2; }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

*:not(pre) > code { font-size: inherit; padding: 2px; white-space: nowrap; background-color: #eeeeee; border: 0 solid #dddddd; -webkit-border-radius: 0; border-radius: 0; text-shadow: none; }

pre, pre > code { line-height: 1.5; color: white; font-family: Monaco, Consolas, "Courier New", Courier, Sans-serif; font-weight: normal; }

kbd.keyseq { color: #555555; }

kbd:not(.keyseq) { display: inline-block; color: #222222; font-size: 0.75em; line-height: 1.4; background-color: #F7F7F7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset; margin: -0.15em 0.15em 0 0.15em; padding: 0.2em 0.6em 0.2em 0.5em; vertical-align: middle; white-space: nowrap; }

kbd kbd:first-child { margin-left: 0; }

kbd kbd:last-child { margin-right: 0; }

.menuseq, .menu { color: #090909; }

p a > code:hover { color: #151515; }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 0.9375em; padding-right: 0.9375em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#header { margin-bottom: 2.5em; }
#header > h1 { color: black; font-weight: normal; border-bottom: 1px solid #dddddd; margin-bottom: -28px; padding-bottom: 32px; }
#header span { color: #6f6f6f; }
#header #revnumber { text-transform: capitalize; }
#header br { display: none; }
#header br + span { padding-left: 3px; }
#header br + span:before { content: "\2013 \0020"; }
#header br + span.author { padding-left: 0; }
#header br + span.author:before { content: ", "; }

#toc { border-bottom: 1px solid #dddddd; padding-bottom: 1.25em; }
#toc > ul { margin-left: 0.25em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
#toc ul { list-style-type: none; }

#toctitle { color: #111111; }

@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; }
  #toc.toc2 { position: fixed; width: 20em; left: 0; top: 0; border-right: 1px solid #dddddd; border-bottom: 0; z-index: 1000; padding: 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; }
  #toc.toc2 > ul { font-size: .95em; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1.25em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; }
  body.toc2.toc-right #toc.toc2 { border-right: 0; border-left: 1px solid #dddddd; left: auto; right: 0; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; border-width: 0; -webkit-border-radius: 0; border-radius: 0; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }
#content #toc a { text-decoration: none; }

#content #toctitle { font-weight: bold; font-family: "Helvetica Neue", "Helvetica", sans-serif; font-size: 1em; padding-left: 0.125em; }

#footer { max-width: 100%; background-color: #222222; padding: 1.25em; }

#footer-text { color: #dddddd; line-height: 1.35; }

.sect1 { padding-bottom: 1.25em; }

.sect1 + .sect1 { border-top: 1px solid #dddddd; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; width: 1em; margin-left: -1em; display: block; text-decoration: none; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: '\00A7'; font-size: .85em; vertical-align: text-top; display: block; margin-top: 0.05em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #111111; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #040404; }

.imageblock, .literalblock, .listingblock, .verseblock, .videoblock { margin-bottom: 1.25em; }

.admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title, .videoblock > .title, .listingblock > .title, .literalblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-align: left; font-weight: bold; }

.tableblock > caption { text-align: left; font-weight: bold; white-space: nowrap; overflow: visible; max-width: 0; }

table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }

.admonitionblock > table { border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #dddddd; color: #6f6f6f; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 0; border-radius: 0; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }
.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6, .exampleblock > .content p { color: #333333; }
.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6 { line-height: 1; margin-bottom: 0.625em; }
.exampleblock > .content h1.subheader, .exampleblock > .content h2.subheader, .exampleblock > .content h3.subheader, .exampleblock > .content .subheader#toctitle, .sidebarblock.exampleblock > .content > .subheader.title, .exampleblock > .content h4.subheader, .exampleblock > .content h5.subheader, .exampleblock > .content h6.subheader { line-height: 1.4; }

.exampleblock.result > .content { -webkit-box-shadow: 0 1px 8px #d9d9d9; box-shadow: 0 1px 8px #d9d9d9; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 0; border-radius: 0; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6, .sidebarblock p { color: #333333; }
.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6 { line-height: 1; margin-bottom: 0.625em; }
.sidebarblock h1.subheader, .sidebarblock h2.subheader, .sidebarblock h3.subheader, .sidebarblock .subheader#toctitle, .sidebarblock > .content > .subheader.title, .sidebarblock h4.subheader, .sidebarblock h5.subheader, .sidebarblock h6.subheader { line-height: 1.4; }
.sidebarblock > .content > .title { color: #111111; margin-top: 0; line-height: 1.5; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock > .content pre, .listingblock > .content pre { background: #333333; border-width: 0; padding: 10px; word-wrap: break-word; }
.literalblock > .content pre.nowrap, .listingblock > .content pre.nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
.literalblock > .content pre > code, .listingblock > .content pre > code { display: block; }
@media only screen { .literalblock > .content pre, .listingblock > .content pre { font-size: 0.8em; } }
@media only screen and (min-width: 768px) { .literalblock > .content pre, .listingblock > .content pre { font-size: 0.9em; } }
@media only screen and (min-width: 1280px) { .literalblock > .content pre, .listingblock > .content pre { font-size: 1em; } }

.listingblock > .content { position: relative; }

.listingblock:hover code[class*=" language-"]:before { text-transform: uppercase; font-size: 0.9em; color: #999; position: absolute; top: 0.375em; right: 0.375em; }

.listingblock:hover code.asciidoc:before { content: "asciidoc"; }
.listingblock:hover code.clojure:before { content: "clojure"; }
.listingblock:hover code.css:before { content: "css"; }
.listingblock:hover code.groovy:before { content: "groovy"; }
.listingblock:hover code.html:before { content: "html"; }
.listingblock:hover code.java:before { content: "java"; }
.listingblock:hover code.javascript:before { content: "javascript"; }
.listingblock:hover code.python:before { content: "python"; }
.listingblock:hover code.ruby:before { content: "ruby"; }
.listingblock:hover code.scss:before { content: "scss"; }
.listingblock:hover code.xml:before { content: "xml"; }
.listingblock:hover code.yaml:before { content: "yaml"; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: '$'; }

table.pyhltable { border: 0; margin-bottom: 0; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

.highlight.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #dddddd; }

.highlight.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background-color: transparent !important; padding-right: 0 !important; }

.quoteblock { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
.quoteblock blockquote { margin: 0 0 1.25em 0; padding: 0 0 0.5625em 0; border: 0; }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: -.25em; padding-bottom: 0.5625em; font-size: inherit; color: #555555; }
.quoteblock .attribution br { display: none; }
.quoteblock .attribution cite { display: block; margin-bottom: 0.625em; }

table thead th, table tfoot th { font-weight: bold; }

table.tableblock.grid-all { border-collapse: separate; border-spacing: 1px; -webkit-border-radius: 0; border-radius: 0; border-top: 1px solid #dddddd; border-bottom: 1px solid #dddddd; }

table.tableblock.frame-topbot, table.tableblock.frame-none { border-left: 0; border-right: 0; }

table.tableblock.frame-sides, table.tableblock.frame-none { border-top: 0; border-bottom: 0; }

table.tableblock td .paragraph:last-child p, table.tableblock td > p:last-child { margin-bottom: 0; }

th.tableblock.halign-left, td.tableblock.halign-left { text-align: left; }

th.tableblock.halign-right, td.tableblock.halign-right { text-align: right; }

th.tableblock.halign-center, td.tableblock.halign-center { text-align: center; }

th.tableblock.valign-top, td.tableblock.valign-top { vertical-align: top; }

th.tableblock.valign-bottom, td.tableblock.valign-bottom { vertical-align: bottom; }

th.tableblock.valign-middle, td.tableblock.valign-middle { vertical-align: middle; }

p.tableblock.header { color: #222222; font-weight: bold; }

td > div.verse { white-space: pre; }

ol { margin-left: 1.75em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.625em; }

ul.unstyled, ol.unnumbered, ul.checklist, ul.none { list-style-type: none; }

ul.unstyled, ol.unnumbered, ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > i[class^="icon-check"]:first-child, ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { position: relative; top: 1px; }

ul.inline { margin: 0 auto 0.625em auto; margin-left: -1.375em; margin-right: 0; padding: 0; list-style: none; overflow: hidden; }
ul.inline > li { list-style: none; float: left; margin-left: 1.375em; display: block; }
ul.inline > li > * { display: block; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1 { padding-right: .8em; font-weight: bold; }

td.hdlist1, td.hdlist2 { vertical-align: top; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist > table tr > td:first-of-type { padding: 0 .8em; line-height: 1; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }

.qanda > ol > li > p > em:only-child { color: #96111a; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }

.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; }

span.footnote, span.footnoteref { vertical-align: super; font-size: 0.875em; }
span.footnote a, span.footnoteref a { text-decoration: none; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -.25em 0 .75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em; line-height: 1.3; font-size: 0.875em; margin-left: 1.2em; text-indent: -1.2em; margin-bottom: .2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }

#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: none; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > [class^="icon-"], span.icon > [class*=" icon-"] { cursor: default; }

.admonitionblock td.icon [class^="icon-"]:before { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #ad141e; color: #820f16; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }

.conum { display: inline-block; color: white !important; background-color: #222222; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; width: 20px; height: 20px; font-size: 12px; font-weight: bold; line-height: 20px; font-family: Arial, sans-serif; font-style: normal; position: relative; top: -2px; letter-spacing: -1px; }
.conum * { color: white !important; }
.conum + b { display: none; }
.conum:after { content: attr(data-value); }
.conum:not([data-value]):empty { display: none; }

</style>
</head>
<body class="article">
<div id="header">
</div>
<div id="content">
<div class="sect1">
<h2 id="_building_a_crm_app_with_nodejs_repl_it_and_mongodb">Building a CRM app with NodeJS, Repl.it, and MongoDB</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this tutorial we’ll use NodeJS on Repl.it, along with a MongoDB
database to build a basic
<a href="https://en.wikipedia.org/wiki/Create,_read,_update_and_delete">CRUD</a>
(Create, Read, Update, Delete)
<a href="https://en.wikipedia.org/wiki/Customer_relationship_management">CRM</a>
(Customer Relationship Management) application. A CRM lets you store
information about customers to help you track the status of every
customer relationship. This can help businesses keep track of their
clients and ultimately increase sales. The application will be able to
store and edit customer details, as well as keep notes about them.</p>
</div>
<div class="paragraph">
<p>This tutorial won’t be covering the basics of Node.js, but each line of
code will be explained in detail.</p>
</div>
<div class="sect2">
<h3 id="_setting_up">Setting up</h3>
<div class="paragraph">
<p>All of the code will be written and hosted in Repl.it, so you won’t need
to install any additional software on your computer.</p>
</div>
<div class="paragraph">
<p>For setup, we’ll be walking you through the following steps. Skip any
that don’t apply to you (e.g. if you already have a Repl.it account, you
don’t have to make a new one).</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Creating an account on <a href="https://repl.it/">Repl.it</a></p>
</li>
<li>
<p>Creating an account on <a href="https://www.mongodb.com/cloud/atlas">MongoDB
Atlas</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_creating_an_account_on_repl_it">Creating an account on Repl.it</h4>
<div class="paragraph">
<p>The first thing you need to do is create an account on Repl.it. You can
find instructions on how to do so
<a href="https://www.codementor.io/garethdwyer/building-a-discord-bot-with-node-js-and-repl-it-mm46r1u8y#creating-an-account-on-replit">here</a>.
Once you’re done, head back here and continue the tutorial.</p>
</div>
</div>
<div class="sect3">
<h4 id="_creating_an_account_on_mongodb_atlas">Creating an account on MongoDB Atlas</h4>
<div class="paragraph">
<p>MongoDB Atlas is a fully managed Database-as-a-Service. It provides a
document database (often referred to as NoSQL), as opposed to a more
traditional relational database like PostgreSQL.</p>
</div>
<div class="paragraph">
<p>Head over to <a href="https://www.mongodb.com/cloud/atlas">MongoDB Atlas</a> and hit
the &#8220;Start free&#8221; button.</p>
</div>
<div class="paragraph">
<p>After signing up, under &#8220;Starter Clusters&#8221;, press the &#8220;Create a
Cluster&#8221; button.</p>
</div>
<div class="paragraph">
<p>You now have to select a provider and a region. For the purposes of this
tutorial we chose Google Cloud Platform as the provider and Iowa
(us-central1) as the region, although it should work regardless of the
provider and region. <span class="image"><img src="https://imgur.com/fHZDo7I.png" alt="Cluster Region"></span></p>
</div>
<div class="paragraph">
<p>Under &#8220;Cluster Name&#8221; you can change the name of your cluster. Note
that you can only change the name now - it can’t be changed once the
cluster is created. After you’ve done that, click &#8220;Create Cluster&#8221;.
<span class="image"><img src="https://imgur.com/fqvBpGQ" alt="Cluster Name"></span></p>
</div>
<div class="paragraph">
<p>After a bit of time, your cluster will be created. Once it’s available,
click on &#8220;Database Access&#8221; under the Security heading in the left-hand
column and then click &#8220;Add New User&#8221; to create a new database user.
You need a database user to actually store and retrieve data. Enter a
username and password for the user and make a note of those details -
you’ll need them later. Select &#8220;Read and write to any database&#8221; as the
user privilege.</p>
</div>
<div class="paragraph">
<p>Next, you need to allow network access to the database. Click on
&#8220;Network Access&#8221; in the left-hand column, and &#8220;Add an IP Address&#8221;.
Because we won’t have a static IP from Repl.it, we’re just going to
allow access from anywhere - don’t worry, the database is still secured
with the username and password you created earlier. In the popup, click
&#8220;Allow Access From Anywhere&#8221;.
<span class="image"><img src="https://imgur.com/YUoVxHk.png" alt="Allow Access From Anywhere"></span></p>
</div>
<div class="paragraph">
<p>Navigate back to &#8220;Clusters&#8221;, click on &#8220;Connect&#8221; and select &#8220;Connect
Your Application&#8221;. Copy the Connection String as you will need it
shortly to connect to your database from Repl.it. Ours looked like this:
<code>mongodb+srv://&lt;username&gt;:&lt;password&gt;@cluster0-zrtwi.gcp.mongodb.net/test?retryWrites=true&amp;w=majority</code></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creating_a_repl_and_connecting_to_our_database">Creating a Repl and connecting to our Database</h3>
<div class="paragraph">
<p>First, we need to create a new Node.js Repl to write the code necessary
to connect to our shiny new Database. On Repl.it, create a new Repl and
select &#8220;Node.js&#8221; as the language.</p>
</div>
<div class="paragraph">
<p>A great thing about Repl is that it makes projects public by default.
This makes it easy to share and is great for collaboration and learning,
but we have to be careful not to make our database credentials available
on the open Internet.</p>
</div>
<div class="paragraph">
<p>To solve this problem we’ll be using <code>environment variables</code>. We’ll
create a special file that Repl.it recognizes and keeps private for you,
and in that file we declare variables that become part of our Repl.it
development environment and are accessible in our code.</p>
</div>
<div class="paragraph">
<p>Select your Repl by clicking &#8220;My Repls&#8221; in the left-hand pane,
followed by clicking on the Repl’s name. Now create a file called
<code>.env</code> by selecting &#8220;Files&#8221; in the left-hand pane and then clicking
the &#8220;Add File&#8221; button. Note that the spelling has to be exact or the
file will not be recognized. Add your MongoDB database username and
password (not your login details to MongoDB Atlas) into the file in the
below format:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>MONGO_USERNAME=username
MONGO_PASSWORD=password</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Replace <code>username</code> and <code>password</code> with your database username and
password</p>
</li>
<li>
<p><strong>Spacing matters</strong>. Make sure that you don’t add any spaces before or
after the <code>=</code> sign</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now that we have credentials set up for the database, we can move on to
connecting to it in our code.</p>
</div>
<div class="paragraph">
<p>MongoDB is kind enough to provide a client that we can use. To test out
our database connection, we’re going to insert some customer data into
our database. In your <code>index.js</code> file (created automatically and found
under the Files pane), add the following code:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>const MongoClient = require('mongodb').MongoClient;
const mongo_username = process.env.MONGO_USERNAME
const mongo_password = process.env.MONGO_PASSWORD

const uri = `mongodb+srv://${mongo_username}:${mongo_password}@cluster0-zrtwi.gcp.mongodb.net/crmdb?retryWrites=true&amp;w=majority`;
const client = new MongoClient(uri, { useNewUrlParser: true });</pre>
</div>
</div>
<div class="paragraph">
<p>Here’s what’s going on:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Line 1</strong> adds the dependency for the MongoDB Client. Repl.it makes
things easy by installing all the dependencies for us, so we don’t have
to use something like npm to do it manually.</p>
</li>
<li>
<p><strong>Line 2 &amp; 3</strong> we retrieve our MongoDB username and password from the
environment variables that we set up earlier.</p>
</li>
<li>
<p><strong>Line 5</strong> has a few very important details that we need to get right.</p>
<div class="ulist">
<ul>
<li>
<p>replace the section between the <code>@</code> and the next <code>/</code> with the
same section of your connection string from MongoDB that we copied
earlier. You may notice the <code>${mongo_username}</code> and
<code>${mongo_password}</code> before and after the colon near the beginning of
the string. These are called Template Literals. Template Literals allow
us to put variables in a string, which Node.js will then helpfully
replace with the actual values of the variables.</p>
</li>
<li>
<p>Note <code>crmdb</code> after the <code>/</code> and before the <code>?</code>. This will be the
name of the database that we will be using. MongoDB creates the database
if it doesn’t exist for us. You can change this to whatever you want to
name the database, but remember what you changed it to for future
sections of this tutorial.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Line 6</strong> creates the client that we will use to connect to the
database.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_making_a_user_interface_to_insert_customer_data">Making a user interface to insert customer data</h3>
<div class="paragraph">
<p>We’re going to make an HTML form that will capture the customer data,
send it to our Repl.it code, which will then insert it into our
database.</p>
</div>
<div class="paragraph">
<p>In order to actually present and handle an HTML form, we need a way to
process HTTP GET and POST requests. The easiest way to do this is to use
a web application framework. A web application framework is designed to
support the development of web applications - it gives you a standard
way to build your application and lets you get to building your
application fast without having to do the boilerplate code.</p>
</div>
<div class="paragraph">
<p>A really simple and flexible Node.js web application framework is
<a href="https://expressjs.com/">Express</a>. Express is a fast and flexible web
application framework that provides a robust set of features for the
development of web applications.</p>
</div>
<div class="paragraph">
<p>The first thing we need to do is add the dependencies we need. Right at
the top of your index.js file, add the following lines:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>let express = require('express');
let app = express();
let bodyParser = require('body-parser');
let http = require('http').Server(app);

app.use(bodyParser.json())
app.use(bodyParser.urlencoded({ extended: true }));</pre>
</div>
</div>
<div class="paragraph">
<p>Let’s break this down.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Line 1</strong> adds the dependency for Express. Repl.it will take care of
installing it for us.</p>
</li>
<li>
<p><strong>Line 2</strong> creates a new Express app that will be needed to handle
incoming requests.</p>
</li>
<li>
<p><strong>Line 3</strong> adds a dependency for &#8216;body-parser&#8217;. This is needed for the
Express server to be able to handle the data that the form will send,
and give it to us in a useful way in code.</p>
</li>
<li>
<p><strong>Line 4</strong> adds a dependency for a basic HTTP server.</p>
</li>
<li>
<p><strong>Line 6 &amp; 7</strong> tell the Express app which parsers to use on incoming
data. This is needed to handle form data.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Next, we need to add a way for the Express to handle an incoming request
and give us the form that we want. Add the following lines of code below
your dependencies:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>app.get('/', function (req, res) {
  res.sendFile('/index.html', {root:'.'});
});

app.get('/create', function (req, res) {
  res.sendFile('/create.html', {root:'.'});
});</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>app.get</code> tells Express that we want it to handle a GET request.</p>
</li>
<li>
<p><code>'/'</code> tells Express that it should respond to GET requests sent to
the root URL. A root URL looks something like
&#8216;<a href="https://crm.hawkiesza.repl.co&#8217" class="bare">https://crm.hawkiesza.repl.co&#8217</a>; - note that there are no slashes after
the URL.</p>
</li>
<li>
<p><code>'/create'</code> tells Express that it should respond to GET requests to
/create after the root URL i.e. &#8216;<a href="https://crm.hawkiesza.repl.co/create&#8217" class="bare">https://crm.hawkiesza.repl.co/create&#8217</a>;</p>
</li>
<li>
<p><code>res.sendFile</code> tells Express to send the given file as a response.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Before the server will start receiving requests and sending responses,
we need to tell it to run. Add the following code below the previous
line.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>app.set('port', process.env.PORT || 5000);
http.listen(app.get('port'), function() {
    console.log('listening on port', app.get('port'));
});</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Line 1</strong> tells Express to set the port number to either a number
defined as an environment variable, or 5000 if no definition was made.</p>
</li>
<li>
<p><strong>Line 2-4</strong> tells the server to start listening for requests.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now we have an Express server listening for requests, but we haven’t yet
built the form that it needs to send back if it receives a request.</p>
</div>
<div class="paragraph">
<p>Make a new file called <code>index.html</code> and paste the following code into
it:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;body&gt;
&lt;form action="/create" method="GET"&gt;
  &lt;input type="submit" value="Create"&gt;
&lt;/form&gt;

&lt;/body&gt;
&lt;/html&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>This is just a simple bit of HTML that puts a single button on the page.
When this button is clicked it sends a GET request to <code>/create</code>, which
the server will then respond to according to the code that we wrote
above - in our case it will send back the <code>create.html</code> file which we
will define now.</p>
</div>
<div class="paragraph">
<p>Make a new file called <code>create.html</code> and paste the following into it:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;body&gt;

&lt;h2&gt;Customer details&lt;/h2&gt;

&lt;form action="/create" method="POST"&gt;
  &lt;label for="name" &gt;Customer name *&lt;/label&gt;&lt;br&gt;
  &lt;input type="text" id="name" name="name" class="textInput" placeholder="John Smith" required&gt;
  &lt;br&gt;
  &lt;label for="address" &gt;Customer address *&lt;/label&gt;&lt;br&gt;
  &lt;input type="text" name="address" class="textInput" placeholder="42 Wallaby Way, Sydney" required&gt;
  &lt;br&gt;
  &lt;label for="telephone" &gt;Customer telephone *&lt;/label&gt;&lt;br&gt;
  &lt;input type="text" name="telephone" class="textInput" placeholder="+275554202" required&gt;
  &lt;br&gt;
  &lt;label for="note" &gt;Customer note&lt;/label&gt;&lt;br&gt;
  &lt;input type="text" name="note" class="textInput" placeholder="Needs a new pair of shoes"&gt;
  &lt;br&gt;&lt;br&gt;
  &lt;input type="submit" value="Submit"&gt;
&lt;/form&gt;

&lt;/body&gt;
&lt;/html&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>We won’t go in depth into the above HTML. It is a very basic form with 4
fields (name, address, telephone, note) and a Submit button, which
creates an interface that will look like the one below.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="https://imgur.com/Y1IIDq6.png" alt="Customer Details"></span></p>
</div>
<div class="paragraph">
<p>When the user presses the submit button a POST request is made to
<code>/create</code> with the data in the form - we still have to handle this
request in our code as we’re currently only handling a GET request to
<code>/</code>.</p>
</div>
<div class="paragraph">
<p>If you now start up your application (click the &#8220;run&#8221; button) a new
window should appear on the right that displays your form. You can also
navigate to <code>https://&lt;repl_name&gt;.&lt;your_username&gt;.repl.co</code> (replace
with whatever you named your Repl (but with no underscores or spaces)
and with your Repl username) to see the form. You will be able to see
this URL in your Repl itself.</p>
</div>
<div class="paragraph">
<p>If you fill in the form and click submit, you’ll get a response back
that says <code>Cannot POST /create</code>. We haven’t added the code that
handles the form POST request, so let’s do that. Add the following code
into your <code>index.js</code> file, below the <code>app.get</code> entry that we made
above.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>app.post('/create', function (req, res, next) {
  client.connect(err =&gt; {
    const customers = client.db("crmdb").collection("customers");

    let customer = { name: req.body.name, address: req.body.address, telephone: req.body.telephone, note: req.body.note };
    customers.insertOne(customer, function(err, res) {
      if (err) throw err;
      console.log("1 customer inserted");
    });
  })
  res.send('Customer created');
})</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Line 1</strong> defines a new route that listens for an HTTP &#8216;POST&#8217; request
at <code>/create</code>.</p>
</li>
<li>
<p><strong>Line 2</strong> connects to the database. This happens asynchronously, so we
define a callback function that will be called once the connection is
done.</p>
</li>
<li>
<p><strong>Line 3</strong> creates a new collection of customers. Collections in MongoDB
are similar to Tables in SQL.</p>
</li>
<li>
<p><strong>Line 5</strong> defines customer data that will be inserted into the
collection. This is taken from the incoming request. The form data is
parsed using the parsers that we defined earlier and is then placed in
the <code>req.body</code> variable for us to use in the code.</p>
</li>
<li>
<p><strong>Line 6</strong> inserts the customer data into the collection. This also
happens asynchronously, and so we define another callback function that
will get an error if an error occurred, or the response if everything
happened successfully.</p>
</li>
<li>
<p><strong>Line 7</strong> throws an error if the above insert had a problem.</p>
</li>
<li>
<p><strong>Line 8</strong> gives us some feedback that the insert happened successfully.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you now fill in the form and click submit, you’ll get a message back
that says &#8220;Customer created&#8221;. If you then go and look in your MongoDB
collection, you’ll see a document has been created with the details that
we submitted in the form.</p>
</div>
</div>
<div class="sect2">
<h3 id="_updating_and_deleting_database_entries">Updating and deleting database entries</h3>
<div class="paragraph">
<p>As a final step in this tutorial, we want to be able to update and
delete database documents in our collection. To make things simpler
we’re going to make a new HTML page where we can request a document and
then update or delete it.</p>
</div>
<div class="paragraph">
<p>First, let’s make the routes to our new page. In your <code>index.js</code>, add
the following code below the rest of your routing code:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>app.get('/get', function (req, res) {
  res.sendFile('/get.html', {root:'.'});
});

app.get('/get-client', function (req, res) {
    client.connect(err =&gt; {
        client.db("crmdb").collection("customers").findOne({name: req.query.name}, function(err, result) {
          if (err) throw err;
          res.render('update', {oldname: result.name, oldaddress: result.address, oldtelephone: result.telephone, oldnote: result.note, name: result.name, address: result.address, telephone: result.telephone, note: result.note});
        });
      });
});</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Line 1-3</strong> as before, this tells Express to respond to incoming GET
requests on <code>/get</code> by sending the <code>get.html</code> file which we will
define below.</p>
</li>
<li>
<p><strong>Line 5-12</strong> this tells Express to respond to incoming GET requests on
<code>/get-client</code>.</p>
<div class="ulist">
<ul>
<li>
<p><strong>Line 7</strong> makes a call to the database to fetch a customer by name. If
there are more than 1 with the same name, then the first one found will
be returned.</p>
</li>
<li>
<p><strong>Line 9</strong> tells Express to render the <code>update</code> template, replacing
variables with the given values as it goes. Important to note here is
that we are also replacing values in the hidden form fields we created
earlier with the current values of the customer details. This is to
ensure that we update or delete the correct customer.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>In your <code>index.html</code> file, add the following code after the
<code>&lt;/form&gt;</code> tag:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;br&gt;
&lt;form action="/get" method="GET"&gt;
  &lt;input type="submit" value="Update/Delete"&gt;
&lt;/form&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>This adds a new button that will make a GET request to <code>/get</code>, which
will then return <code>get.html</code>.
<span class="image"><img src="https://imgur.com/CHymS42.png" alt="Index"></span></p>
</div>
<div class="paragraph">
<p>Make a new file called <code>get.html</code> with the following contents:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;body&gt;
  &lt;form action="/get-client" method="GET"&gt;
    &lt;label for="name" &gt;Customer name *&lt;/label&gt;&lt;br&gt;
    &lt;input type="text" id="name" name="name" class="textInput" placeholder="John Smith" required&gt;
    &lt;input type="submit" value="Get customer"&gt;
  &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>This makes a simple form with an input for the customer’s name and a
button. <span class="image"><img src="https://imgur.com/Pnji1Nl.png" alt="Get Customer"></span></p>
</div>
<div class="paragraph">
<p>Clicking this button will then make a GET call to <code>/get-client</code> which
will respond with the client details where we will be able to update or
delete them.</p>
</div>
<div class="paragraph">
<p>To actually see the customer details on a form after requesting them, we
need a templating engine to render them onto the HTML page and send the
rendered page back to us. With a templating engine, you define a
template - a page with variables in it - and then give it the values you
want to fill into the variables. In our case, we’re going to request the
customer details from the database and tell the templating engine to
render them onto the page.</p>
</div>
<div class="paragraph">
<p>We’re going to use a templating engine called
<a href="https://pugjs.org/api/getting-started.html">Pug</a>. Pug is a simple
templating engine that integrates fully with Express. The syntax that
Pug uses is very similar to HTML. One important difference in the syntax
is that spacing is very important as it determines your parent/child
hierarchy.</p>
</div>
<div class="paragraph">
<p>First, we need to tell Express which templating engine to use and where
to find our templates. Put the following line above your route
definitions (i.e. after the other app. lines in index.js):</p>
</div>
<div class="literalblock">
<div class="content">
<pre>app.engine('pug', require('pug').__express)
app.set('views', '.')
app.set('view engine', 'pug')</pre>
</div>
</div>
<div class="paragraph">
<p>Now create a new file called <code>update.pug</code> with the following content:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>html
  body
    p #{message}
    h2= 'Customer details'
    form(method='POST' action='/update')
      input(type='hidden' id='oldname' name='oldname' value=oldname)
      input(type='hidden' id='oldaddress' name='oldaddress' value=oldaddress)
      input(type='hidden' id='oldtelephone' name='oldtelephone' value=oldtelephone)
      input(type='hidden' id='oldnote' name='oldnote' value=oldnote)
      label(for='name') Customer name:
      br
      input(type='text', placeholder='John Smith' name='name' value=name)
      br
      label(for='address') Customer address:
      br
      input(type='text', placeholder='42 Wallaby Way, Sydney' name='address' value=address)
      br
      label(for='telephone') Customer telephone:
      br
      input(type='text', placeholder='+275554202' name='telephone' value=telephone)
      br
      label(for='note') Customer note:
      br
      input(type='text', placeholder='Likes unicorns' name='note' value=note)
      br
      button(type='submit' formaction="/update") Update
      button(type='submit' formaction="/delete") Delete</pre>
</div>
</div>
<div class="paragraph">
<p>This is very similar to the HTML form we created previously for
<code>create.html</code>, however this is written in the Pug templating language.
We’re creating a hidden element to store the &#8220;old&#8221; name, telephone,
address, and note of the customer - this is for when we want to do an
update.</p>
</div>
<div class="paragraph">
<p>Using the old details to update the customer is an easy solution, but
not the best solution as it makes the query cumbersome and slow. If you
add extra fields in your database you would have to remember to update
your query as well, otherwise it could lead to updating or deleting the
wrong customer if they have the same information. A better, but more
complicated way is to use the unique ID of the database document as that
will only ever refer to one customer.</p>
</div>
<div class="paragraph">
<p>We have also put in placeholder variables for name, address, telephone,
and note, and we have given the form 2 buttons with different actions.</p>
</div>
<div class="paragraph">
<p>If you now run the code, you will have an index page with 2 buttons.
Pressing the &#8216;Update/Delete&#8217; button will take you to a new page that
asks for a Customer name. Filling the customer name and pressing &#8216;Get
customer&#8217; will, after a little time, load a page with the customer’s
details and 2 buttons below that say &#8216;Update&#8217; and &#8216;Delete&#8217;.
<span class="image"><img src="https://imgur.com/m1lxFhs.png" alt="Update-Delete"></span></p>
</div>
<div class="paragraph">
<p>Our next step is to add the &#8216;Update&#8217; and &#8216;Delete&#8217; functionality. Add
the following code below your routes in <code>index.js</code>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>app.post('/update', function(req, res) {
  client.connect(err =&gt; {
    if (err) throw err;
    let query = { name: req.body.oldname, address: req.body.oldaddress, telephone: req.body.oldtelephone, note: req.body.oldnote };
    let newvalues = { $set: {name: req.body.name, address: req.body.address, telephone: req.body.telephone, note: req.body.note } };
    client.db("crmdb").collection("customers").updateOne(query, newvalues, function(err, result) {
        if (err) throw err;
        console.log("1 document updated");
        res.render('update', {message: 'Customer updated!', oldname: req.body.name, oldaddress: req.body.address, oldtelephone: req.body.telephone, oldnote: req.body.note, name: req.body.name, address: req.body.address, telephone: req.body.telephone, note: req.body.note});
      });
  });
})

app.post('/delete', function(req, res) {
  client.connect(err =&gt; {
    if (err) throw err;
    let query = { name: req.body.name, address: req.body.address ? req.body.address : null, telephone: req.body.telephone ? req.body.telephone : null, note: req.body.note ? req.body.note : null };
    client.db("crmdb").collection("customers").deleteOne(query, function(err, obj) {
      if (err) throw err;
      console.log("1 document deleted");
      res.send(`Customer ${req.body.name} deleted`);
    });
  });
})</pre>
</div>
</div>
<div class="paragraph">
<p>This introduces 2 new &#8216;POST&#8217; handlers - one for <code>/update</code>, and one
for <code>/delete</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Line 2</strong> connects to our MongoDB database.</p>
</li>
<li>
<p><strong>Line 3</strong> throws an error if there was a problem connecting to the
database.</p>
</li>
<li>
<p><strong>Line 4</strong> defines a query that we will use to find the document to
update. In this case, we are using the details of the customer <em>before</em>
it was updated. We saved this name earlier in a hidden field in the
HTML. Trying to find the customer by its updated name obviously won’t
work because it hasn’t been updated yet. Also, note that we are setting
some of the fields to null if they are empty. This is so that the
database returns the correct document when we update or delete - if we
search for a document that has no address with an address of ’’ (empty
string), then our query won’t return anything.</p>
</li>
<li>
<p><strong>Line 5</strong> defines the new values that we want to update our customer
with.</p>
</li>
<li>
<p><strong>Line 6</strong> updates the customer with the new values using the query</p>
</li>
<li>
<p><strong>Line 7</strong> throws an error if there was a problem with the update.</p>
</li>
<li>
<p><strong>Line 8</strong> logs that a document was updated.</p>
</li>
<li>
<p><strong>Line 9</strong> re-renders the update page with a message saying that the
customer was updated, and displays the new values.</p>
</li>
<li>
<p><strong>Line 15</strong> connects to our MongoDB database.</p>
</li>
<li>
<p><strong>Line 16</strong> throws an error if there was a problem connecting to the
database.</p>
</li>
<li>
<p><strong>Line 17</strong> defines a query that we will use to find the document to
delete. In this case we are using all the details of the customer
<em>before</em> any changes were made on the form to make sure we delete that
specific customer.</p>
</li>
<li>
<p><strong>Line 18</strong> we connect to the database and delete the customer.</p>
</li>
<li>
<p><strong>Line 19</strong> throws an error if there was a problem with the delete.</p>
</li>
<li>
<p><strong>Line 20</strong> logs that a document was deleted.</p>
</li>
<li>
<p><strong>Line 21</strong> sends a response to say that the customer was deleted.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_putting_it_all_together">Putting it all together</h3>
<div class="paragraph">
<p>If you run your application now, you’ll be able to create, update, and
delete documents in a MongoDB database. This is a very basic CRUD
application, with a very basic and unstyled UI, but it should give you
the foundation to build much more sophisticated applications.</p>
</div>
<div class="paragraph">
<p>For instance, you could add fields to the database to classify customers
according to which stage they are in your sales
<a href="https://www.bitrix24.com/glossary/what-is-pipeline-management-definition-crm.php">pipeline</a>
so that you can track if a customer is potentially stuck somewhere and
contact them to re-engage.</p>
</div>
<div class="paragraph">
<p>You could then integrate some basic marketing automation with a page
allowing you to send an email or SMS to customers (though don’t spam
clients!).</p>
</div>
<div class="paragraph">
<p>You could also add fields to keep track of customer purchasing
information so that you can see which products do well with which
customers.</p>
</div>
<div class="paragraph">
<p>If you want to start from where this tutorial leaves off, simply fork
the Repl at <a href="https://repl.it/@GarethDwyer1/nodejs-crm" class="bare">https://repl.it/@GarethDwyer1/nodejs-crm</a>. To get additional
guidance from the Repl community, also join Repl’s Discord server by
using this invite link <a href="https://discord.gg/QWFfGhy" class="bare">https://discord.gg/QWFfGhy</a>.</p>
</div>
<div class="paragraph">
<p><em>This article was contributed by Gerrit Vermeulen and edited by
Katherine James.</em></p>
</div>
</div>
</div>
</div>
</div>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/monokai.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
<script>hljs.initHighlighting()</script>
</body>
</html>